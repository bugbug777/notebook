(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{271:function(s,t,a){s.exports=a.p+"assets/img/git-reflog-reset.1bd30484.png"},272:function(s,t,a){s.exports=a.p+"assets/img/revert-chechout-reset.d8ba16a3.png"},293:function(s,t,a){"use strict";a.r(t);var e=a(10),n=Object(e.a)({},(function(){var s=this,t=s._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h1",{attrs:{id:"git-advanced"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#git-advanced"}},[s._v("#")]),s._v(" Git Advanced")]),s._v(" "),t("p",[s._v("紀錄 Git 相對進階一點的知識。")]),s._v(" "),t("h2",{attrs:{id:"選擇性加入索引"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#選擇性加入索引"}},[s._v("#")]),s._v(" 選擇性加入索引")]),s._v(" "),t("p",[s._v("此為 "),t("code",[s._v("git add")]),s._v(" 的進階應用。")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 選擇部分內容加入索引（暫存區），檔案需要先被提交過")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# s 切割更小區塊")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# y 加入該區塊到暫存區")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# n 略過該區塊")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# e 手動編輯")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("add")]),s._v(" -p\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br")])]),t("h2",{attrs:{id:"復原檔案"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#復原檔案"}},[s._v("#")]),s._v(" 復原檔案")]),s._v(" "),t("p",[s._v("三種復原的方法")]),s._v(" "),t("ul",[t("li",[t("code",[s._v("git checkout")])]),s._v(" "),t("li",[t("code",[s._v("git revert")])]),s._v(" "),t("li",[t("code",[s._v("git reset")])])]),s._v(" "),t("h3",{attrs:{id:"git-checkout"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#git-checkout"}},[s._v("#")]),s._v(" "),t("code",[s._v("git checkout")])]),s._v(" "),t("p",[s._v("常用於復原單一檔案，但此做法在重設工作目錄時效率低下，會轉而使用 "),t("code",[s._v("git reset --hard")])]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 方法一")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" checkout FileName\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Example")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" checkout index.html\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br")])]),t("p",[s._v("復原"),t("strong",[s._v("單一檔案")]),s._v("，但由於還原的檔案取自暫存區，因此當修改過的檔案一但進入到暫存區，就無法還原到被修改之前的狀態。")]),s._v(" "),t("p",[s._v("更進一步的來說，如果被修改的檔案進到暫存區，此時如若又對這份被修改過的檔案且已進入到暫存區，又對其進行修改，接著又對該檔案使用 "),t("code",[s._v("git checkout FileName")]),s._v("，則會還原到剛進暫存區的狀態，因為此時心修改的內容尚未被加入到暫存區。")]),s._v(" "),t("p",[s._v("為了不要讓上述的問題混淆，可以透過指定 Commit ID 解決此問題。")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 方法二")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" checkout Commit_ID FileName\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Example")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" checkout HEAD index.html\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br")])]),t("p",[s._v("透過方法二恢復檔案，恢復的檔案預設會被加入到暫存區，如果有新的修改，必須要重新 "),t("code",[s._v("git add")]),s._v(" 到暫存區中。")]),s._v(" "),t("h3",{attrs:{id:"git-revert"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#git-revert"}},[s._v("#")]),s._v(" "),t("code",[s._v("git revert")])]),s._v(" "),t("p",[s._v("復原 commit 做過的事情，並且自動提交 commit。")]),s._v(" "),t("p",[s._v("使用情境，在修復 bug 時以為已修復並提交，結果發現 bug 依然存在，即可透過此指令進行復原。")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 取消自動提交")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" revert Commit_ID -n\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 搭配 git commit --amend 使用，修復最後一筆")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" revert Commit_ID -n\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" commit --amend -m "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Some Completed Text"')]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 連續的 rollback（需注意 commit 連貫性，即順序")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" revert Commit_ID_1 Commit_ID_2 Commit_ID_3\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br")])]),t("h3",{attrs:{id:"git-reset"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#git-reset"}},[s._v("#")]),s._v(" "),t("code",[s._v("git reset")])]),s._v(" "),t("p",[s._v("使用 "),t("code",[s._v("git checkout main")]),s._v(" 也可以達成類似的效果，但是被修改的異動，並不會還原，而是連帶附加上去。")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 清除、重設當前的暫存區以及工作目錄")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" reset --hard\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 清除、重設當前的暫存區、工作目錄，並移動分支、HEAD 到指定 commit")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" reset Commit_ID --hard\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 保持工作目錄不變, 清除暫存區")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" reset --mixed\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# reset 至某個 commit, 但保持工作目錄不變, 清除暫存區，主要用於 打散或合併commit")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" reset Commit_ID --mixed\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 分支、HEAD、工作目錄、暫存區皆不變（基本沒有用途")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" reset --soft\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 重設分支、HEAD，但工作目錄、暫存區皆不變")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" reset Commit_ID --soft\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br")])]),t("p",[s._v("使用 "),t("code",[s._v("git reset --hard")]),s._v(" 可能會導致錯誤的重置，因此使用必須特別小心，不過假如修改的內容曾經提交，那麼即使被 reset 依舊可以透過 "),t("code",[s._v("git reflog")]),s._v(" 之類的指令進行修復。（前提是 git 還未執行 garbage collection, 應該是 30 days")]),s._v(" "),t("h3",{attrs:{id:"查閱-head-的歷史移動紀錄"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#查閱-head-的歷史移動紀錄"}},[s._v("#")]),s._v(" 查閱 "),t("code",[s._v("HEAD")]),s._v(" 的歷史移動紀錄")]),s._v(" "),t("p",[s._v("透過 "),t("code",[s._v("git reflog")]),s._v(" 找到要復原的節點，搭配 "),t("code",[s._v("git reset Commit_ID --hard")]),s._v(" 即可修復。")]),s._v(" "),t("p",[t("img",{attrs:{src:a(271),alt:"git reflog"}})]),s._v(" "),t("h3",{attrs:{id:"revert-vs-checkout-vs-reset"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#revert-vs-checkout-vs-reset"}},[s._v("#")]),s._v(" revert vs. checkout vs. reset")]),s._v(" "),t("p",[t("img",{attrs:{src:a(272),alt:"比較流程圖"}})]),s._v(" "),t("h2",{attrs:{id:"切換視點"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#切換視點"}},[s._v("#")]),s._v(" 切換視點")]),s._v(" "),t("p",[s._v("透過 "),t("code",[s._v("git checkout")]),s._v(" 移動 "),t("code",[s._v("HEAD")]),s._v("，但由於 "),t("code",[s._v("git log")]),s._v(" 預設只會顯示 "),t("code",[s._v("HEAD")]),s._v(" 以前的提交紀錄，因此如果需要查看完整的提交紀錄，可以使用 "),t("code",[s._v("git log --all")])]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" checkout Commit_ID\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("如果要移動 "),t("code",[s._v("HEAD")]),s._v(" 重新指回 "),t("code",[s._v("main")]),s._v(" 分支，只需要使用以下語法")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" checkout main\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("此部分也是可以透過 Commit_ID 指向與 main 一樣視點，但差異在於直接將 "),t("code",[s._v("HEAD")]),s._v(" 指向 Commit_ID，在下次進行提交時，分支 "),t("code",[s._v("main")]),s._v(" 就不會同步更新，並且 Commit_ID 並沒有比 "),t("code",[s._v("main")]),s._v(" 分支名稱來得更容易記憶，因此使用分支名稱，會是比較好的做法。")]),s._v(" "),t("h2",{attrs:{id:"標籤"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#標籤"}},[s._v("#")]),s._v(" 標籤")]),s._v(" "),t("p",[s._v("建立重大里程碑。")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 建立標籤")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" tag -a "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"v1.0"')]),s._v(" -m "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"message"')]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查閱標籤紀錄")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" cat-file -p v1.0\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br")])])])}),[],!1,null,null,null);t.default=n.exports}}]);